{% extends 'base.html' %}
{% block content %}
<div class="p-4 bg-white rounded shadow space-y-3">
  <div class="font-semibold text-center text-xl">Kiosk cho session #{{ session_id }}</div>
  <div class="flex justify-center">
    <img id="qrImage" class="border w-64 h-64" alt="QR Code" />
  </div>
  <div class="text-xs text-gray-600 text-center">Token: <span id="tokenText"></span></div>
  <div class="text-xs text-gray-500 text-center">Tự động cập nhật mỗi 25 giây</div>
</div>
<script>
  async function fetchQR() {
    try {
      const res = await fetch(`/qr/generate/{{ session_id }}`);
      const data = await res.json();
      document.getElementById('qrImage').src = data.qr_image;
      document.getElementById('tokenText').textContent = data.token;
    } catch (error) {
      console.error('Error fetching QR:', error);
    }
  }
  
  fetchQR();
  setInterval(fetchQR, 25000);
</script>
{% endblock %}
